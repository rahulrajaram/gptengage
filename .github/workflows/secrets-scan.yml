name: Secret Scanning

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master, develop ]

jobs:
  trufflehog:
    name: TruffleHog Secret Scan
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Full history for scanning

      - name: Run TruffleHog (pinned image)
        uses: docker://ghcr.io/trufflesecurity/trufflehog@sha256:214da7bcbf60f71db229bc5b6d790bf46eb1e8d068faa59838c1dba59738bc85
        with:
          args: >-
            filesystem
            --only-verified
            --exclude-paths .trufflehog_exclude.txt
            --fail
            .
